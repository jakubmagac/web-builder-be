class BootstrapBadgeFactory extends BadgeFactory {
    _createBadge(items) {
        const badge = document.createElement('span');
        badge.classList.add('badge', 'badge-pill', 'badge-info');
        return badge;
    }
}

document.addEventListener('DOMContentLoaded', function () {
    new LanguagePickerHandler().handle();
    const connector = new ObjectivesConnector();
    connector.badgeFactory = new BootstrapBadgeFactory();
    connector.connect();
    autohideNavbar();
});

function autohideNavbar() {
    let didScroll = false;
    let lastScrollTop = 0;
    let delta = 5;
    const navbar = document.querySelector('.navbar-autoreveal');
    const navbarExpandButton = navbar.querySelector('.navbar-toggler');

    window.addEventListener('scroll', function() {
        didScroll = true;
    });

    setInterval(function() {
        if (didScroll) {
            hasScrolled();
            didScroll = false;
        }
    }, 250);

    function hasScrolled() {
        let scrollTop = window.scrollY;
        if (Math.abs(lastScrollTop - scrollTop) <= delta) return;

        let isNavbarExpanded = navbarExpandButton.attributes['aria-expanded'].value === 'true';
        let isScrolledDown = scrollTop > lastScrollTop;
        let isBelowNavbar = scrollTop > navbar.clientHeight;

        if (!isNavbarExpanded && isScrolledDown && isBelowNavbar) {
            navbar.classList.add('navbar-autoreveal-up');
        } else {
            navbar.classList.remove('navbar-autoreveal-up');
        }

        lastScrollTop = scrollTop;
    }
}

